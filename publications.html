<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Publications — Yuxin Dong</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/citation-js@0.6.1/build/citation.min.js"></script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <h1 class="site-title">Yuxin Dong <span class="chinese">| 董雨欣</span></h1>
            <nav class="site-nav">
                <a href="/index.html">Home</a>
                <a href="/research.html">Research</a>
                <a href="/publications.html" class="active">Publications</a>
                <a href="/contact.html">Contact</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <h2>Publications</h2>
        <div class="publications-header">
            <p>Publication list automatically updated from ORCID/ADS. View my complete record on <a href="https://orcid.org/0000-0002-9363-8606">ORCID</a>.</p>
            <div class="format-controls">
                <button onclick="switchFormat('apa')" class="btn ghost">APA</button>
                <button onclick="switchFormat('bibtex')" class="btn ghost">BibTeX</button>
                <button onclick="downloadBibTeX()" class="btn">Download BibTeX</button>
            </div>
        </div>

        <div id="publications-list" class="publication-list">
            <div class="loading">Loading publications...</div>
        </div>

        <footer class="site-footer">
            <p>© 2025 Yuxin Dong | 董雨欣</p>
        </footer>
    </main>

    <script>
        // Configuration
        const ORCID_ID = '0000-0002-9363-8606';
        const ADS_TOKEN = ''; // We'll add this later if you provide it

        // Fetch publications from ORCID
        async function fetchPublications() {
            try {
                const response = await fetch(`https://pub.orcid.org/v3.0/${ORCID_ID}/works`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                const data = await response.json();
                return processPublications(data);
            } catch (error) {
                console.error('Error fetching publications:', error);
                document.getElementById('publications-list').innerHTML = `
                    <div class="publication-item">
                        <h3 class="publication-title">Dong, Y. et al. 2022, ApJ, 927, 199</h3>
                        <p>Ca-rich transients host galaxy study</p>
                        <div class="publication-links">
                            <a href="https://ui.adsabs.harvard.edu/abs/2022ApJ...927..199D/abstract">ADS</a>
                            <a href="#" onclick="showBibTeX('dong2022')">BibTeX</a>
                        </div>
                    </div>
                `;
            }
        }

        // Process and display publications
        function processPublications(data) {
            const publications = data.group || [];
            const container = document.getElementById('publications-list');
            
            if (publications.length === 0) {
                container.innerHTML = '<p>No publications found. Please check back later.</p>';
                return;
            }

            container.innerHTML = publications
                .map(pub => {
                    const title = pub.work-summary?.[0]?.title?.title?.value || 'Untitled';
                    const year = pub.work-summary?.[0]?.publication-date?.year?.value || '';
                    const journal = pub.work-summary?.[0]?.journal-title?.value || '';
                    
                    return `
                        <div class="publication-item" data-aos="fade-up">
                            <h3 class="publication-title">${title}</h3>
                            <p class="publication-meta">${journal} (${year})</p>
                            <div class="publication-links">
                                <a href="https://ui.adsabs.harvard.edu/abs/${pub.path}/abstract">ADS</a>
                                <a href="#" onclick="showBibTeX('${pub.path}')">BibTeX</a>
                            </div>
                        </div>
                    `;
                })
                .join('');
        }

        // Format switching and download functionality
        let currentFormat = 'apa';
        function switchFormat(format) {
            currentFormat = format;
            fetchPublications(); // Refresh with new format
        }

        function downloadBibTeX() {
            // Implementation for BibTeX download
            const bibtex = `@article{dong2022,
    author = {Dong, Yuxin and others},
    title = {Ca-rich Transients Study},
    journal = {ApJ},
    volume = {927},
    pages = {199},
    year = {2022},
    doi = {10.3847/1538-4357/ac4d9c}
}`;
            
            const blob = new Blob([bibtex], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'publications.bib';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', fetchPublications);
    </script>
</body>
</html>